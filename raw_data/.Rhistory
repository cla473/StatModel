library(tidyverse)
library(emmeans)
setwd("C:/Users/cla473/Documents/DataSchool/StatModel/raw_data")
#=====================================================
barley <- read.csv("Prac 3 barley yield.csv")
str(barley)
names(barley) <- c("X", "Location", "Variety", "1930", "1931")
barley2 <- barley %>%
gather(key="Year", value="Yield", "1930", "1931")
barley2$Year <- factor(barley2$Year)
str(barley2)
ggplot(barley2, aes(Variety, Yield, colour=Year)) +
geom_point(position=position_dodge(width=0.5))
ggplot(barley2, aes(Location, Yield, colour=Variety)) +
geom_boxplot()
lmb4 <- lm(Yield~Variety+Location, data=barley2)
anova(lmb4)
lmb5 <- lm(Yield~Variety+Location+Year, data=barley2)
anova(lmb5)
emmeans(lmb5, pairwise~Variety)
emmeans(lmb5, pairwise~Variety|year)
emmeans(lmb5, pairwise~Variety+year)
lmb5 <- lm(Yield~Variety+Location+Year, data=barley2)
anova(lmb5)
emmeans(lmb5, pairwise~Variety)
libarary(ImerTest)
install.packages("ImerTest")
install.packages("lmerTest")
photo <- read.csv("Prac 4 photosynthesis.csv")
str(photo)
photo$Temp <- factor(photo$Temp)
model1 <- lm(PhotoRate~Temp, data=photo)
model1
anova(model1)
ggplot(photo, aes(x=Temp, y=PhotoRate, color=Position)) +
geom_point()
photo$Position <- factor(Position)
photo <- read.csv("Prac 4 photosynthesis.csv")
str(photo)
photo$Temp <- factor(photo$Temp)
photo$Position <- factor(photo$Position)
ggplot(photo, aes(x=Temp, y=PhotoRate, color=Position)) +
geom_point()
model1 <- lm(PhotoRate~Temp, data=photo)
anova(model1)
ggplot(photo, aes(x=Position, y=PhotoRate, color=Temp)) +
geom_point()
ggplot(photo, aes(x=Temp, y=PhotoRate, color=Position)) +
geom_point()
ggplot(photo, aes(x=Position, y=PhotoRate, color=Temp)) +
geom_point()
model1 <- lm(PhotoRate~Temp, data=photo)
anova(model1)
model2 <- lm(PhotoRate~Temp=(1|Position), data=photo_
model2 <- lm(PhotoRate~Temp=(1|Position), data=photo)
model2 <- lm(PhotoRate~Temp+(1|Position), data=photo)
anova(model2)
model2 <- lm(PhotoRate~Temp+(1|Position), data=photo)
libarary(lmerTest)  #linear models with variance structure
libarary(lmerTest)  #linear models with variance structure
libarary(lmerTest)
#structure of data
package.install(lmerTest)
#structure of data
packages.install(lmerTest)
libarary(lmerTest)
model1 <- lmer(PhotoRate~Temp, data=photo)
install.packages("lmerTest")
libarary(lmerTest)
library(lmerTest)
model1 <- lmer(PhotoRate~Temp, data=photo)
anova(model1)
model2 <- lmer(PhotoRate~Temp+(1|Position), data=photo)
anova(model2)
summary(model1)
summary(model2)
model2 <- lmer(PhotoRate~Temp, data=photo)
model2 <- lmer(PhotoRate~Temp+(1|Position), data=photo)
anova(model2)
summary(model1)
summary(model2)
model3 <- lmer(PhotoRate~Temp, data=photo)
summary(model3)
model3 <- lmer(PhotoRate~Temp, data=photo)
emmeans(model2, ~Temp)
library(emmeans)
emmeans(model2, ~Temp)
emmeans(model2, ~Temp)
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
library(emmeans)
install.packages("emmeans")
install.packages("emmeans")
emmeans(model2, ~Temp)
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
install.packages("p")
install.packages("emmeans")
install.packages("emmeans")
library(emmeans)
emmeans(model2, ~Temp)
install.packages("pbkrtest")
emmeans(model2, ~Temp)
plot(model2, which=1)
emmeans(model2, pairwise~Temp)
#=================================================================
gene <- read.csv("Prac 5 Arabidopsis nitrogen.csv")
str(gene)
library(tidyverse)
library(lmerTest)
library(emmeans)
setwd("C:/Users/cla473/Documents/DataSchool/StatModel/raw_data")
#=================================================================
drought <- read.csv("Prac 4 drought data.csv")
str(drought)
ggplot(drought, aes(x=WaterConditions, y=Temperature, colour=plant)) +
geom_point()
drought$plant <- factor(drought$plant)
drought$Genotype <- relevel(drought$Genotype, ref="WT")
drought$WaterCondition <- relevel(drought$WaterCondition, ref="Normal")
str(drought)
drought$cond <- with(drought, interaction(WaterCondition, Genotype))
str(drought)
ggplot(drought, aes(x=WaterCondition, y=Temperature, colour=plant)) +
geom_point()
ggplot(drought, aes(x=cond, y=Temperature, colour=plant)) +
geom_point()
ggplot(drought, aes(x=WaterCondition, y=Temperature, colour=plant)) +
geom_point(position=position_dodge(width="0.9"))
ggplot(drought, aes(x=WaterCondition, y=Temperature, colour=plant)) +
geom_point(position=position_dodge(width=0.9))
lm.drought <- lm(Temperature~Genotype*WaterCondition, data=drought)
anova(lm.drought)
lmer.drought <- lmer(Temperature~Genotype*WaterCondition+(1|plant), data=drought)
anova(lmer.drought)
summary(lm.drought)
emmeans(lm.drought)
emmeans(lm.drought, pairwise~Temperature)
emmeans(lm.drought, pairwise~Temperature)
lm.drought
emmeans(lm.drought, pairwise~Genotype*WaterCondition)
emmeans(lmer.drought, pairwise~Genotype*WaterCondition)
emmeans(lm.drought, ~Genotype*WaterCondition)
emmeans(lm.drought, ~Genotype*WaterCondition)
emmeans(lmer.drought, ~Genotype*WaterCondition)
emmeans(lmer.drought, pairwise~Genotype*WaterCondition)
summary(lm.drought)
summary(lmer.drought)
library(tidyverse)
library(lmerTest)
library(emmeans)
setwd("C:/Users/cla473/Documents/DataSchool/StatModel/raw_data")
respire <- read.csv("Prac 4 dark respiration.csv")
str(respire)
respire$Leaf_stage <- factor(respire$Leaf_stage)
respire$Leaf_section <- factor(respire$Leaf_section)
str(respire)
ggplot(respire, aes(x=Species, y=Dry_mass_resp, colour=Leaf_section)) + geom_boxplot()
ggplot(respire, aes(x=Species, y=Dry_mass_resp, colour=Leaf_stage)) + geom_boxplot()
#doesn't seem to be an interaction between section (same pattern for all)
#there is a section effect, no apparent species affect
ggplot(respire, aes(x=Species, y=Dry_mass_resp, colour=Leaf_stage)) + geom_boxplot()
model <- lmer(Dry_mass_resp~Species*Leaf_stage*Leaf_section+(1:Plant_ID) + (1:Leaf_stage:Plant_ID), data=respire)
model <- lmer(Dry_mass_resp~Species*Leaf_stage*Leaf_section+(1:Plant_ID) + (1:Leaf_stage:Plant_ID), data=respire)
model <- lmer(Dry_mass_resp~Species*Leaf_stage*Leaf_section+(1|Plant_ID) + (1|Leaf_stage:Plant_ID), data=respire)
anova(model)
plot(model)
#===========================================================
#Exam
#===========================================================
respire <- read.csv("Prac 5 Arabidopsis nitrogen.csv")
#===========================================================
#Exam
#===========================================================
data <- read.csv("Prac 5 Arabidopsis nitrogen.csv")
str(data)
data$Tank <- factor(plant$Tank)
data$Tank <- factor(data$Tank)
data$Nitrogen <- factor(data$Nitrogen)
data$Day <- factor(data$Day)
str(data)
ggplot(data, aes(x=Nitrogen, y=PlantDM, colour=Day)) + geom_point()
ggplot(data, aes(x=Nitrogen, y=PlantDM, colour=Day)) + geom_point(position=position_dodge())
ggplot(data, aes(x=Nitrogen, y=PlantDM, colour=Day)) + geom_point(position=position_dodge(width=0.9))
ggplot(data, aes(x=Day, y=PlantDM, colour=Nitrogen)) + geom_point(position=position_dodge(width=0.9))
ggplot(data, aes(x=Day, y=PlantDM, colour=Nitrogen)) + geom_boxplot()
ggplot(data, aes(x=Nitrogen, y=PlantDM, colour=Day)) + geom_boxplot()
ggplot(data, aes(x=Day, y=PlantDM, colour=Nitrogen)) + geom_boxplot()
#variability may be an issue over time .... not much variation on day 10
#but much larger variation on day 24
ggplot(data, aes(x=Day, y=log(PlantDM), colour=Nitrogen)) + geom_boxplot()
#===========================================================
#Exam
#===========================================================
AraData <- read.csv("Prac 5 Arabidopsis nitrogen.csv")
str(AraData)
AraData$Tank <- factor(AraData$Tank)
AraData$Nitrogen <- factor(AraData$Nitrogen)
AraData$Day <- factor(AraData$Day)
str(AraData)
ggplot(AraData, aes(x=Nitrogen, y=PlantDM, colour=Day)) + geom_point(position=position_dodge(width=0.9))
ggplot(AraData, aes(x=Day, y=PlantDM, colour=Nitrogen)) + geom_point(position=position_dodge(width=0.9))
ggplot(AraData, aes(x=Day, y=PlantDM, colour=Nitrogen)) + geom_boxplot()
#variability may be an issue over time .... not much variation on day 10
#but much larger variation on day 24
ggplot(AraData, aes(x=Day, y=log(PlantDM), colour=Nitrogen)) + geom_boxplot()
lm1 <- lm(log(plantDM)~Nitrogen*Day, data=AraData)
lm1 <- lm(log(PlantDM)~Nitrogen*Day, data=AraData)
anova(lm1)
lm1 <- lm(PlantDM~Nitrogen*Day, data=AraData)
anova(lm1)
lm2 <- lm(log(PlantDM)~Nitrogen*Day, data=AraData)
anova(lm2)
lm1er <- lmer(PlantDM~Nitrogen*Day+(1|Tank))
lm1er <- lmer(PlantDM~Nitrogen*Day+(1|Tank), data=AraData)
lm1er
lm1er <- lmer(log(PlantDM)~Nitrogen*Day+(1|Tank), data=AraData)
lm1er <- lmer(PlantDM~Nitrogen*Day+(1|Tank), data=AraData)
lm1er2 <- lmer(log(PlantDM)~Nitrogen*Day+(1|Tank), data=AraData)
lm1er2
anova(lm1er)
anover(lm1er2)
anova(lm1er2)
anova(lm2)
anova(lm1er2)
#the 'type="response"' converts from log back to real values
emmeans(lmler2, ~Nitrogen, type="response")
#the 'type="response"' converts from log back to real values
emmeans(lm1er2, ~Nitrogen, type="response")
#the 'type="response"' converts from log back to real values
emmeans(lm1er2, ~Nitrogen*Day, type="response")
#the 'type="response"' converts from log back to real values
emmeans(lm1er, ~Nitrogen*Day)
emmeans(lm1er2, ~Nitrogen*Day, type="response")
emmeans(lm1er2, Pairwise~Nitrogen*Day, type="response")
emmeans(lm1er2, pairwise~Nitrogen*Day, type="response")
emmeans(lm1er2, pairwise~Nitrogen|Day, type="response")
plot(lm1er2)
plot(lm1er)
#========================================================================================
plants <- read.csv("Prac 5 plant growth.csv")
str(plants)
plants$Dose <- factor(plants$Dose)
plants$Row <- factor(plants$Row)
plants$Column <- factor(plants$Column)
ggplot(plants, aes(x=Dose, y=height, colours=Row)) + geom_point()
ggplot(plants, aes(x=Dose, y=height, colour=Row)) + geom_point() +
facet_grid(~Column)
ggplot(plants, aes(x=Dose, y=height)) + geom_point()
lmp <- lm(height~Dose, data=plants)
summary(lmp)
anova(lmp)
lmp2 <- lm(height~as.numeric(Dose), data=plants)
summary(lmp2)
anova(lmp2)
lm3 <- lmer(height~as.numeric(Dose) +(1|Row)+(1|Column), data=AraData)
lm3 <- lmer(height~as.numeric(Dose) +(1|Row)+(1|Column), data=plants)
lm3
anova(lm3)
lm4 <- lmer(height~Dose +(1|Row)+(1|Column), data=plants)
anova(lm4)
summary(lm4)
emmeans(lm4, ~Dose)
emmeans(lm4, pairwise~Dose)
plot(lm4)
#====================================================================
nem <- read.csv(("Prac 5 nematode.csv"))
str(nem)
nem$Experiment <- factor(nem$Experiment)
str(new)
str(nem)
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) + geom_plot()
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) + geom_point()
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) + geom_point(position=position_dodge(width=0.9))
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_boxplot()
nem$Genotype <- relevel(nem$Genotype, ref="WT")
new$Treatment <- relevel(nem$Treatment, ref="Uninfected")
str(nem)
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_point(position=position_dodge(width=0.9))
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_boxplot()
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_boxplot() +
facet_wrap(~Experment)
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_boxplot() +
facet_wrap(~Experiment)
ggplot(nem, aes(x=Genotype, y=Plant.weight, colour=Treatment)) +
geom_boxplot()
lmn <- lm(Plant.weigh~Genotype*Treatment)
summary(lmn)
lmn <- lm(Plant.weight~Genotype*Treatment)
summary(lmn)
lmn <- lm(Plant.weight~Genotype*Treatment)
lmn <- lm(Plant.weight~Genotype*Treatment, data=nem)
lmn2 <- lmer(Plant.weight~Genotype*Treatment + (1|Experiment), data=nem)
summary(lmn2)
anova(lmn2)
lmn <- lm(Plant.weight~Genotype*Treatment, data=nem)
summary(lmn)
anova(lmn)
emmeans(lmn, pairwise~Genotype)
plot(lmn)
#=================================================================
banana <- read.csv("Prac 5 respiration data.csv")
str(banana)
banana$shelter <- factor(banana$shelter)
banana$Temp <- factor(banana$Temp, levels = c("low", "med", "high", "very high"))
str(banana)
banana$plantID <- factor(banana$plantID)
str(banana)
ggplot(banana, aes(x=Genotype, y=rrarea1, colour=Temp) + geom_point()
ggplot(banana, aes(x=Genotype, y=rrarea1, colour=Temp)) + geom_point()
ggplot(banana, aes(x=Genotype, y=rrarea1, colour=Temp)) + geom_point(position=position_dodge(width=0.5))
banana$Temp <- factor(banana$Temp, levels = c("low", "med", "high", "vhigh"))
str(banana)
ggplot(banana, aes(x=Genotype, y=rrarea1, colour=Temp)) + geom_point(position=position_dodge(width=0.5))
View(banana)
#=================================================================
banana <- read.csv("Prac 5 respiration data.csv")
str(banana)
banana$Temp <- factor(banana$Temp, levels = c("low", "med", "high", "v high"))
banana$shelter <- factor(banana$shelter)
banana$plantID <- factor(banana$plantID)
str(banana)
ggplot(banana, aes(x=Genotype, y=rrarea1, colour=Temp)) + geom_point(position=position_dodge(width=0.5))
model1 <- lmer(rrareal~Genotype*Temp + (1|shelter) + (1|plantId:shelter), data=banana)
model1 <- lm(rrarea1~Genotype*Temp+shelter+plantId) data=banana)
model1 <- lm(rrarea1~Genotype*Temp+shelter+plantId, data=banana)
model2 <- lmer(rrarea1~Genotype*Temp + (1|shelter) + (1|plantID:shelter), data=banana)
anova(model2)
summary(model2)
emmeans(model2, ~Genotype)
emmeans(model2, pairwise~Genotype)
model2 <- lmer(rrarea1~Genotype*Temp*shelter + (1|shelter) + (1|plantID:shelter), data=banana)
anova(model2)
summary(model2)
model2 <- lmer(rrarea1~Genotype*Temp*shelter + (1|shelter) + (1|plantID:shelter), data=banana)
anova(model2)
summary(model2)
model2 <- lmer(rrarea1~Genotype*Temp+shelter + (1|shelter) + (1|plantID:shelter), data=banana)
anova(model2)
summary(model2)
plot(model2, which:1)
plot(model2, which=1)
emmeans(model2, ~Genotype)
emmeans(model2, pairwise~Genotype)
